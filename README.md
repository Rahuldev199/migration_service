<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Daily Report</title>
</head>

<body style="color: #000000; font-family: Arial, sans-serif; background: #E9EAEC; padding-left: 25px; min-width: 95%;">
    <table>
        <tr>
              <td>
                <table >
                    <tr>
                          <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;">
                            <div style="font-weight: 200;font-size: 14pt;padding-bottom: 5px;padding-top: 25px;text-transform: uppercase;">
							 ORDER COUNT
                            </div>
                            <div>
                                 <table style="background-color: whitesmoke;  border: 1px solid #000000;  margin: 5px 0;  font-size: 0.9em;  font-family: sans-serif;  min-width: 95%;  table-layout: auto;  box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);">
                                   <tr style="background-color: #333652;color: #ffffff !important;text-align: left;text-transform: uppercase;">
                                        <th>Flow Types</th>
                                        <th>ORDER COUNT</th>
                                    </tr>
                                                                                <tr>
                                                  <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;">0</td>
                                                  <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;">0</td>
                                                  <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;">0</td>
                                                  <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;">0</td>

                                            </tr>
                                </table>
                            </div>
                            <div style="font-weight: 200;font-size: 14pt;padding-bottom: 5px;padding-top: 25px;text-transform: uppercase;">
                                SUMMARY
                            </div>
                            <div>
                                 <table style="background-color: whitesmoke;  border: 1px solid #000000;  margin: 5px 0;  font-size: 0.9em;  font-family: sans-serif;  min-width: 95%;  table-layout: auto;  box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);">
                                    <tr style="background-color: #333652;color: #ffffff !important;text-align: center;text-transform: uppercase;">
                                        <th colspan="1"></th>
                                        <th colspan="3">DataSync</th>
                                        <th colspan="2">DataCompare</th>
                                        <th colspan="2">Payload</th>
                                    </tr>
                                    <tr style="background-color: #333652;color: #ffffff !important;text-align: center;text-transform: uppercase;">
                                        <th>Flow Type</th>
                                        <th>SUCCESS</th>
                                        <th>FAILURE</th>
                                        <th>INPROGRESS</th>
                                        <th>SUCCESS</th>
                                        <th>FAILURE</th>
                                        <th>SUCCESS</th>
                                        <th>FAILURE</th>
                                    </tr>
                                        <tr>
                                              <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;"></td>
                                              <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;"></td>
                                              <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;"></td>
                                              <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;"></td>
                                              <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;">1</td>
                                              <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;">1</td>
                                              <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;"></td>
                                              <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;"></td>
                                        </tr>
                                        <tr>
                                              <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;"></td>
                                              <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;"></td>
                                              <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;"></td>
                                              <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;"></td>
                                              <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;"></td>
                                              <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;"></td>
                                              <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;"></td>
                                              <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;"></td>
                                        </tr>
                                </table>
                            
                            <div style="font-weight: 200;font-size: 14pt;padding-bottom: 5px;padding-top: 25px;text-transform: uppercase;">
                                DATA COMPARE
                            </div>
                            <div>
                                 <table style="background-color: whitesmoke;  border: 1px solid #000000;  margin: 5px 0;  font-size: 0.9em;  font-family: sans-serif;  min-width: 95%;  table-layout: auto;  box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);">
                                   <tr style="background-color: #333652;color: #ffffff !important;text-align: left;text-transform: uppercase;">
                                        <th>Flow Types</th>
                                        <th>MILESTONE</th>
                                        <th>SUCCESS</th>
                                        <th>FAILURE</th>
                                    </tr>
                                        <tr>
                                              <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;">Others</td>
                                              <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;">SubmitPayment</td>
                                              <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;">1</td>
                                              <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;">1</td>
                                        </tr>
                                </table>
                            </div>
                            <div style="font-weight: 200;font-size: 14pt;padding-bottom: 5px;padding-top: 25px;text-transform: uppercase;">
                                API COMPARE
                            </div>
                            <div>
                                 <table style="background-color: whitesmoke;  border: 1px solid #000000;  margin: 5px 0;  font-size: 0.9em;  font-family: sans-serif;  min-width: 95%;  table-layout: auto;  box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);">
                                   <tr style="background-color: #333652;color: #ffffff !important;text-align: left;text-transform: uppercase;">
                                        <th>Flow Types</th>
                                        <th>API TYPE</th>
                                        <th>SUCCESS</th>
                                        <th>FAILURE</th>
                                    </tr>
                                            <tr>
                                                  <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;">0</td>
                                                  <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;">0</td>
                                                  <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;">0</td>
                                                  <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;">0</td>
                                            </tr>
                                </table>
                            </div>
                            
                            <div style="font-weight: 200;font-size: 14pt;padding-bottom: 5px;padding-top: 25px;text-transform: uppercase;">
                                DATA SYNC
                            </div>
                            <div>
                                 <table style="background-color: whitesmoke;  border: 1px solid #000000;  margin: 5px 0;  font-size: 0.9em;  font-family: sans-serif;  min-width: 95%;  table-layout: auto;  box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);">
                                   <tr style="background-color: #333652;color: #ffffff !important;text-align: left;text-transform: uppercase;">
                                        <th>Flow Types</th>
                                        <th>TYPE_DEF_NAME</th>
                                        <th>SUCCESS</th>
                                        <th>FAILURE</th>
                                        <th>INPROCESSING</th>
                                    </tr>
                                            <tr>
                                                  <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;">0</td>
                                                  <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;">0</td>
                                                  <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;">0</td>
                                                  <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;">0</td>
                                                  <td style="border: 1px solid #000000;padding: 5px 5px 5px 5px;">0</td>
                                            </tr>
                                </table>
                            </div>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</body>

</html>


=============================

public void dynamicSelectQuery(MigrationConfig.Config config, List<Query> queryList,
                                   CXPRequest<DataSyncRequest> dataSyncRequest, Map<String, String> flattenPayload) throws ExecutionException, InterruptedException {
        List<MigrationConfig.SelectQueryList> selectQueryLists = config.getDatasync().getSelectQueryList();
        for (MigrationConfig.SelectQueryList selectQuery : selectQueryLists) {
            MigrationConfig.QueryConfig queryConfig = new MigrationConfig.QueryConfig();
            queryConfig.setQueryId(selectQuery.getQueryId());
            queryConfig.setParams(selectQuery.getWhereParam());
            String ProdParallelFlag = null;
            if (StringUtils.isBlank(dataSyncRequest.getData().getProdParallelFlag())) {
                ProdParallelFlag = migrationConfig.getProdParallelFlag();
            } else {
                ProdParallelFlag = dataSyncRequest.getData().getProdParallelFlag();
            }
            List<RequestQuery> requestQueryList  = new ArrayList<>();
            if (ProdParallelFlag.equalsIgnoreCase("Y")) {
                requestQueryList = GenerateJson.getJsonForSecondaryPOSDBQuery(queryConfig, flattenPayload);
            } else if (ProdParallelFlag.equalsIgnoreCase("N")) {
                List<ToolsRequestQuery> toolsRequestQueries = GenerateJson.getJsonForPrimaryPOSDBQuery(queryConfig, flattenPayload);
                requestQueryList.addAll(toolsRequestQueries);
            }
            for(RequestQuery requestQuery : requestQueryList) {
                ResponseResult resultResponse = queryService.executeQuery(requestQuery).toFuture().get();
                if (resultResponse.getStatus().equals(DataSyncConstant.SUCCESS)) {
                    JSONArray obj = new JSONArray(resultResponse.getPayload().toString());
                    if (obj.length() != 0) {
                        queryList.removeIf(query -> query.getQueryId().equals(selectQuery.getInsertQueryId()));
                    } else {
                        queryList.removeIf(query -> query.getQueryId().equals(selectQuery.getUpdateQueryId()));
                    }
                }
            }
        }
